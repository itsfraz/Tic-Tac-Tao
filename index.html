<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <title>Enhanced Tic Tac Toe</title>
</head>
<body>
  <style>
    /* General Reset */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background-color: #77aff8;
  color: #333;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  flex-direction: column;
  padding: 20px;
  transition: background-color 0.3s ease, color 0.3s ease;
}

h1 {
  margin-bottom: 20px;
  text-align: center;
  color: #444;
}

.game-container {
  display: grid;
  grid-template-columns: repeat(3, 100px);
  grid-gap: 10px;
  margin-bottom: 20px;
}

.cell {
  width: 100px;
  height: 100px;
  background-color: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 2.5rem;
  font-weight: 600;
  cursor: pointer;
  border: 1px solid #ddd;
  border-radius: 8px;
  transition: background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  user-select: none;
}

.cell:hover {
  background-color: #f5f5f5;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  transform: scale(1.05);
}

.cell.X {
  color: #e74c3c;
}

.cell.O {
  color: #3498db;
}

.status {
  margin-top: 15px;
  font-size: 1.25rem;
  text-align: center;
  font-weight: 500;
}

.scoreboard {
  margin-top: 10px;
  font-size: 1.1rem;
  display: flex;
  gap: 25px;
  justify-content: center;
  margin-bottom: 20px;
}

.reset-btn,
.dark-mode-btn,
.player-select-btn {
  margin-top: 15px;
  padding: 12px 25px;
  font-size: 1.1rem;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  font-weight: 500;
}

.reset-btn {
  background-color: #2ecc71;
  color: white;
}

.reset-btn:hover {
  background-color: #27ae60;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.25);
  transform: translateY(-2px);
}

.dark-mode-btn {
  background-color: #3498db;
  color: white;
}

.dark-mode-btn:hover {
  background-color: #2980b9;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.25);
  transform: translateY(-2px);
}

.player-select-btn {
  background-color: #9b59b6;
  color: white;
}

.player-select-btn:hover {
  background-color: #8e44ad;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.25);
  transform: translateY(-2px);
}

/* Dark Mode */
body.dark-mode {
  background-color: #34495e;
  color: #ecf0f1;
}

body.dark-mode .cell {
  background-color: #2c3e50;
  border-color: #34495e;
  color: #fff;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

body.dark-mode .cell:hover {
  background-color: #34495e;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
  transform: scale(1.05);
}

body.dark-mode .reset-btn {
  background-color: #27ae60;
  color: #fff;
}

body.dark-mode .reset-btn:hover {
  background-color: #2ecc71;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
  transform: translateY(-2px);
}

body.dark-mode .dark-mode-btn {
  background-color: #2980b9;
  color: #fff;
}

body.dark-mode .dark-mode-btn:hover {
  background-color: #3498db;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
  transform: translateY(-2px);
}

body.dark-mode .player-select-btn {
  background-color: #8e44ad;
  color: #fff;
}

body.dark-mode .player-select-btn:hover {
  background-color: #9b59b6;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
  transform: translateY(-2px);
}

/* Celebration container */
.celebration {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  display: none;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  z-index: 1000;
}

.sparkles {
  position: absolute;
  width: 10px;
  height: 10px;
  background: radial-gradient(circle, #ffd700, transparent);
  border-radius: 50%;
  animation: sparkleMove 1s ease-out forwards;
}
@keyframes sparkleMove {
  0% {
    transform: translate(0, 0) scale(1);
    opacity: 1;
  }
  100% {
    transform: translate(var(--x), var(--y)) scale(0);
    opacity: 0;
  }
}
.sparkles::before,
.sparkles::after {
  content: "";
  position: absolute;
  width: 20px;
  height: 20px;
  background: radial-gradient(circle, #ffd700, transparent);
  border-radius: 50%;
  animation: sparkle 1.5s infinite ease-in-out;
}

.sparkles::before {
  top: 0;
  left: 0;
  animation-delay: 0s;
}

.sparkles::after {
  bottom: 0;
  right: 0;
  animation-delay: 0.75s;
}

@keyframes sparkle {
  0%, 100% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(1.5);
    opacity: 0.5;
  }
}

.congrats-message {
  color: #ffd700;
  font-size: 2rem;
  font-weight: bold;
  text-align: center;
  margin-top: 20px;
}

/* Responsive Design */
@media (max-width: 768px) {
  .game-container {
    grid-template-columns: repeat(3, 80px);
    grid-gap: 8px;
  }

  .cell {
    width: 80px;
    height: 80px;
    font-size: 2rem;
  }

  .scoreboard {
    flex-direction: column;
    align-items: center;
    gap: 10px;
  }

  .reset-btn,
  .dark-mode-btn,
  .player-select-btn {
    font-size: 1rem;
    padding: 10px 20px;
  }
}

@media (max-width: 480px) {
  h1 {
    font-size: 2rem;
  }

  .scoreboard {
    font-size: 0.9rem;
  }

  .status {
    font-size: 1.1rem;
  }

  .reset-btn,
  .dark-mode-btn,
  .player-select-btn {
    font-size: 0.9rem;
    padding: 8px 16px;
  }
}
  </style>
  <h1>Tic Tac Toe</h1>
  <div class="toggle-container">
    <button class="dark-mode-btn" id="darkModeBtn">Dark Mode</button>
  </div>
  <div class="scoreboard">
    <span>Player X: <span id="playerXScore">0</span></span>
    <span>Draws: <span id="drawScore">0</span></span>
    <span>Player O: <span id="playerOScore">0</span></span>
  </div>

  <div id="modeSelection" style="text-align: center; margin-bottom: 20px;">
    <button class="player-select-btn" id="vsPlayerBtn">Player vs Player</button>
    <button class="player-select-btn" id="vsComputerBtn">Player vs Computer</button>
  </div>

  <div class="game-container" id="gameContainer">
    </div>
  <div class="status" id="status">Select a game mode to start!</div>
  <button class="reset-btn" id="resetBtn">Reset Game</button>

  <div id="celebration" class="celebration">
    <div class="sparkles"></div>
    <div class="congrats-message">Congratulations! You Win!</div>
  </div>

  <audio id="moveSound" src="https://www.soundjay.com/button/beep-07.wav"></audio>
  <audio id="winSound" src="https://www.soundjay.com/misc/success-02.mp3"></audio>
  <audio id="drawSound" src="https://www.soundjay.com/misc/fail-01.mp3"></audio>

  <script >
    const gameContainer = document.getElementById("gameContainer");
const statusDisplay = document.getElementById("status");
const resetButton = document.getElementById("resetBtn");
const darkModeButton = document.getElementById("darkModeBtn");

// Mode selection buttons
const modeSelectionContainer = document.getElementById("modeSelection");
const vsPlayerBtn = document.getElementById("vsPlayerBtn");
const vsComputerBtn = document.getElementById("vsComputerBtn");

const moveSound = document.getElementById("moveSound");
const winSound = document.getElementById("winSound");
const drawSound = document.getElementById("drawSound");

let currentPlayer = "";
let gameState = ["", "", "", "", "", "", "", "", ""];
let gameActive = false;
let gameMode = ""; // 'pvp' or 'pvc'
let computerPlayer = "O"; // Computer is always 'O'

const winningConditions = [
  [0, 1, 2],
  [3, 4, 5],
  [6, 7, 8],
  [0, 3, 6],
  [1, 4, 7],
  [2, 5, 8],
  [0, 4, 8],
  [2, 4, 6],
];

let playerXScore = 0;
let playerOScore = 0;
let drawScore = 0;

// Initialize the game board
function createBoard() {
  for (let i = 0; i < 9; i++) {
    const cell = document.createElement("div");
    cell.classList.add("cell");
    cell.dataset.index = i;
    cell.addEventListener("click", handleCellClick);
    gameContainer.appendChild(cell);
  }
}

// Handle cell click events
function handleCellClick(event) {
  if (!gameActive || (gameMode === "pvc" && currentPlayer === computerPlayer)) {
    return;
  }
  const clickedCell = event.target;
  const clickedIndex = parseInt(clickedCell.dataset.index);
  if (gameState[clickedIndex] !== "") {
    return;
  }
  makeMove(clickedIndex, currentPlayer);
  if (gameActive && gameMode === "pvc") {
    gameContainer.style.pointerEvents = "none";
    setTimeout(() => {
      computerMove();
      gameContainer.style.pointerEvents = "auto";
    }, 700);
  }
}

// Helper function to check for a winner on a given board state
function checkWinner(board, player) {
  for (const condition of winningConditions) {
    const [a, b, c] = condition;
    if (board[a] === player && board[b] === player && board[c] === player) {
      return true;
    }
  }
  return false;
}

// Smarter computer move logic
function computerMove() {
  if (!gameActive) return;
  const humanPlayer = computerPlayer === "X" ? "O" : "X";
  for (let i = 0; i < 9; i++) {
    if (gameState[i] === "") {
      const nextState = [...gameState];
      nextState[i] = computerPlayer;
      if (checkWinner(nextState, computerPlayer)) {
        makeMove(i, computerPlayer);
        return;
      }
    }
  }
  for (let i = 0; i < 9; i++) {
    if (gameState[i] === "") {
      const nextState = [...gameState];
      nextState[i] = humanPlayer;
      if (checkWinner(nextState, humanPlayer)) {
        makeMove(i, computerPlayer);
        return;
      }
    }
  }
  if (gameState[4] === "") {
    makeMove(4, computerPlayer);
    return;
  }
  const corners = [0, 2, 6, 8];
  const availableCorners = corners.filter((i) => gameState[i] === "");
  if (availableCorners.length > 0) {
    const move =
      availableCorners[Math.floor(Math.random() * availableCorners.length)];
    makeMove(move, computerPlayer);
    return;
  }
  const sides = [1, 3, 5, 7];
  const availableSides = sides.filter((i) => gameState[i] === "");
  if (availableSides.length > 0) {
    const move =
      availableSides[Math.floor(Math.random() * availableSides.length)];
    makeMove(move, computerPlayer);
    return;
  }
}

// Generalized function to make a move
function makeMove(index, player) {
  if (!gameActive || gameState[index] !== "") return;
  gameState[index] = player;
  const cell = document.querySelector(`.cell[data-index="${index}"]`);
  cell.classList.add(player);
  cell.textContent = player;
  cell.style.transform = "scale(1.1)";
  if (moveSound) {
    moveSound
      .play()
      .catch((error) => console.error("Sound playback failed:", error));
  }
  setTimeout(() => {
    cell.style.transform = "scale(1)";
  }, 200);
  checkResult();
}

// **UPDATED**: Check for win or draw with new PvP message
function checkResult() {
  let roundWon = false;
  let winningCondition = null;
  for (let condition of winningConditions) {
    const [a, b, c] = condition;
    if (
      gameState[a] &&
      gameState[a] === gameState[b] &&
      gameState[a] === gameState[c]
    ) {
      roundWon = true;
      winningCondition = condition;
      break;
    }
  }

  if (roundWon) {
    highlightWinningCells(winningCondition);
    const winner = currentPlayer;
    let winMessage = "";

    // **UPDATED MESSAGE LOGIC**

    if (gameMode === "pvp") {
      // The 'winner' variable already holds "X" or "O"
      winMessage = `Congratulations Player ${winner}, You Win!`;
    } else if (gameMode === "pvc" && winner === computerPlayer) {
      winMessage = "congratulation Computer wins";
    }

    statusDisplay.textContent = winMessage;
    updateScore(winner);
    if (winSound)
      winSound.play().catch((e) => console.error("Win sound failed", e));
    showCelebration(winner);
    gameActive = false;
    return;
  }

  if (!gameState.includes("")) {
    statusDisplay.textContent = "It's a draw!";
    if (drawSound)
      drawSound.play().catch((e) => console.error("Draw sound failed", e));
    updateScore("draw");
    gameActive = false;
    return;
  }

  currentPlayer = currentPlayer === "X" ? "O" : "X";
  const nextPlayerText =
    gameMode === "pvc" && currentPlayer === computerPlayer
      ? "Computer"
      : `Player ${currentPlayer}`;
  statusDisplay.textContent = `${nextPlayerText}'s turn`;
}

// Highlight winning cells
function highlightWinningCells(condition) {
  condition.forEach((index) => {
    const cell = document.querySelector(`.cell[data-index="${index}"]`);
    cell.style.backgroundColor = "#f1c40f";
    cell.style.color = "#fff";
  });
}

// Update scoreboard
function updateScore(result) {
  if (result === "X") playerXScore++;
  else if (result === "O") playerOScore++;
  else if (result === "draw") drawScore++;
  document.getElementById("playerXScore").textContent = playerXScore;
  document.getElementById("playerOScore").textContent = playerOScore;
  document.getElementById("drawScore").textContent = drawScore;
}

// **UPDATED**: Show celebration animation with new PvP message
function showCelebration(winner) {
  const celebration = document.getElementById("celebration");
  const congratsMessage = celebration.querySelector(".congrats-message");

 
  // **UPDATED MESSAGE LOGIC**
  if (gameMode === "pvp") {
    // The 'winner' variable already holds "X" or "O"
    congratsMessage.textContent = `Congratulations Player ${winner},Win!`;
  } else if (gameMode === "pvc" && winner === computerPlayer) {
    congratsMessage.textContent = "congratulation Computer wins";
  } else {
    congratsMessage.textContent = "Congratulations! You Win!";
  }

  celebration.style.display = "flex";

  for (let i = 0; i < 50; i++) {
    createSparkle();
  }

  setTimeout(() => {
    celebration.style.display = "none";
  }, 5000);
}

// Create a single sparkle
function createSparkle() {
  const sparkle = document.createElement("div");
  sparkle.classList.add("sparkle");
  const x = (Math.random() - 0.5) * 500;
  const y = (Math.random() - 0.5) * 500;
  sparkle.style.setProperty("--x", `${x}px`);
  sparkle.style.setProperty("--y", `${y}px`);
  sparkle.style.animationDelay = `${Math.random() * 0.5}s`;
  document.getElementById("celebration").appendChild(sparkle);
  setTimeout(() => {
    sparkle.remove();
  }, 1000);
}

// Reset the game
function resetGame() {
  gameState = ["", "", "", "", "", "", "", "", ""];
  gameActive = false;
  currentPlayer = "";
  gameMode = "";
  document.querySelectorAll(".cell").forEach((cell) => {
    cell.textContent = "";
    cell.classList.remove("X", "O");
    cell.style.backgroundColor = "";
    cell.style.color = "";
    cell.style.transform = "scale(1)";
  });
  statusDisplay.textContent = "Select a game mode to start!";
  modeSelectionContainer.style.display = "block";
  playerSelection.style.display = "none";
}

// Toggle dark mode
function toggleDarkMode() {
  document.body.classList.toggle("dark-mode");
  const isDarkMode = document.body.classList.contains("dark-mode");
  darkModeButton.textContent = isDarkMode ? "Light Mode" : "Dark Mode";
}

// Updated game start flow
function selectMode(mode) {
  gameMode = mode;
  modeSelectionContainer.style.display = "none";
  if (mode === "pvc") {
    startGame("X");
  } else {
    playerSelection.style.display = "block";
    statusDisplay.textContent = "Select your symbol to start!";
  }
}

// Start the game
function startGame(player) {
  currentPlayer = player;
  gameActive = true;
  statusDisplay.textContent = `Player ${currentPlayer}'s turn`;
  playerSelection.style.display = "none";
}

// Event listeners
resetButton.addEventListener("click", resetGame);
darkModeButton.addEventListener("click", toggleDarkMode);
vsPlayerBtn.addEventListener("click", () => selectMode("pvp"));
vsComputerBtn.addEventListener("click", () => selectMode("pvc"));

// Player selection buttons
const playerSelection = document.createElement("div");
playerSelection.innerHTML = `
      <button class="player-select-btn" data-player="X">Play as X</button>
      <button class="player-select-btn" data-player="O">Play as O</button>
    `;
playerSelection.style.marginBottom = "20px";
playerSelection.style.display = "none";
playerSelection.style.textAlign = "center";
document.body.insertBefore(playerSelection, gameContainer);
// This is the corrected line
playerSelection.querySelectorAll(".player-select-btn").forEach((button) => {
  button.addEventListener("click", (event) => {
    if (gameMode === "pvp") {
      startGame(event.target.dataset.player);
    }
  });
});

// Initialize the game
createBoard();

  </script>
</body>
</html>